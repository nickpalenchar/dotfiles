# Set paths (Apple Silicon Homebrew first)
export PATH="/opt/homebrew/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:$HOME/bin"

# Set default editor to Vim
export EDITOR="vim"

# History settings
HISTFILE=~/.zsh_history
HISTSIZE=5000
SAVEHIST=5000
setopt appendhistory        # Append history instead of overwriting
setopt sharehistory         # Share command history between sessions
setopt hist_ignore_all_dups # Ignore duplicate commands
setopt hist_expire_dups_first # Expire duplicate commands first

# Enable case-insensitive autocompletion
autoload -Uz compinit && compinit
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'

# Prompt settings (New line, background colors, Git branch, and triangle at the end)
NEWLINE=$'\n'
TRIANGLE=""  # Nerd Font Powerline triangle

# Set up precmd hook to update prompt before each command
precmd() {
  __PROMPT_LAST_COLOR="yellow"

  ## Display current git branch if user is in a git repo
  GIT_BRANCH=""
  if command -v git &> /dev/null; then  # Check if git is installed
      local branch="$(git rev-parse --abbrev-ref HEAD 2>/dev/null)"
      if [[ -n "$branch" ]]; then
          # Return both the branch info and set the color
          GIT_BRANCH="%K{magenta} $branch %k"
          __PROMPT_LAST_COLOR="magenta"
      fi
  fi
  # Then construct the prompt using the updated color
  PROMPT="$NEWLINE%F{black}%K{blue} %n %k%K{yellow}%F{black}  %~ %k%F{yellow}%f%K${GIT_BRANCH}%F{$__PROMPT_LAST_COLOR}$TRIANGLE %f"
}

# Alias setup
alias ll="ls -lah"
alias la="ls -A"
alias gs="git status"
alias ..="cd .."
alias ...="cd ../.."
alias vimrc="vim ~/.zshrc"

# Fix pasting issues in terminal
setopt no_nomatch
setopt auto_cd # Allows you to type a directory name to `cd` into it
